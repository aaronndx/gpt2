model = efficient_train(device, data_repo_id="aaronndx/fineweb-edu-10B-shards", steps=19073, B=4, T=2048, context_size=2048, total_batch_size=2**19, log_dir="log", compile=True, eval_every=100, restore_repo_id = "aaronndx/gpt2_checkpoints", restore_from_ckpt_filename=None, save_repo_id="aaronndx/gpt2_checkpoints", save_ckpt_every=100, eval_with_hellaswag=False, learning_mode='fast')
max_lr: 0.0012, min_lr: 0.00011999999999999999, steps: 19073, warmup_steps: 715.2557373046875
0 train 10.9694
1 train 10.8707
2 train 10.6825
3 train 10.4616
4 train 10.2810
5 train 10.1139
6 train 9.9806
7 train 9.8781
8 train 9.7775
9 train 9.7280
9 eval 9.6672
10 train 9.6637
11 train 9.6404
12 train 9.6166
13 train 9.5965
14 train 9.5389
15 train 9.5279
16 train 9.5084
17 train 9.4670
18 train 9.5015
19 train 9.4734
19 eval 9.3164
20 train 9.3498
21 train 9.2903
22 train 9.2606
23 train 9.2336
24 train 9.1483
25 train 9.1055
26 train 9.0739
27 train 9.0091
28 train 8.9488
29 train 8.8750
29 eval 8.8543
30 train 8.8950
31 train 8.8153
32 train 8.7732
33 train 8.7097
34 train 8.5949
35 train 8.5922
36 train 8.5514
37 train 8.4648
38 train 8.4232
39 train 8.4023
39 eval 8.3634
40 train 8.3525
41 train 8.2645
42 train 8.2057
43 train 8.2145
44 train 8.1384
45 train 8.1170
46 train 8.0556
47 train 8.0600
48 train 8.0422
49 train 7.9466
49 eval 7.8966
50 train 7.9557
51 train 7.8924
52 train 7.8468
53 train 7.7761
54 train 7.7736
55 train 7.7473
56 train 7.6900
57 train 7.6641
58 train 7.5795
59 train 7.5407
59 eval 7.4863
60 train 7.5300
61 train 7.5382
62 train 7.4240
63 train 7.3979
64 train 7.3734
65 train 7.3865
66 train 7.3186
67 train 7.3262
68 train 7.3051
69 train 7.1980
69 eval 7.2200
70 train 7.1804
71 train 7.2048
72 train 7.1577
73 train 7.1353
74 train 7.0709
75 train 7.1118
76 train 7.0534
77 train 7.0821
78 train 7.0544
79 train 6.9894
79 eval 7.0332
80 train 6.9865
81 train 7.0059
82 train 6.9507
83 train 6.8952
84 train 6.9182
85 train 6.8740
86 train 6.8514
87 train 6.8903
88 train 6.8578
89 train 6.9034
89 eval 6.8913
90 train 6.8194
91 train 6.8078
92 train 6.8537
93 train 6.9234
94 train 6.9297
95 train 6.9212
96 train 6.8705
97 train 6.8431
98 train 6.8694
99 train 6.8106
99 eval 6.7571
max_lr: 0.0012, min_lr: 0.00011999999999999999, steps: 19073, warmup_steps: 715.2557373046875
100 train 6.8676
101 train 6.7855
102 train 6.7718
103 train 6.6620
104 train 6.7567
105 train 6.7532
106 train 6.7140
107 train 6.6464
108 train 6.7154
109 train 6.7289
109 eval 6.6560
110 train 6.6818
111 train 6.6438
112 train 6.6268
113 train 6.6608
114 train 6.6761
115 train 6.6362
116 train 6.5652
117 train 6.4918
118 train 6.5183
119 train 6.5664
119 eval 6.5624
120 train 6.5272
121 train 6.4987
122 train 6.5027
123 train 6.5001
124 train 6.5078
125 train 6.5032
126 train 6.4911
127 train 6.4486
128 train 6.4101
129 train 6.3931
129 eval 6.4846
130 train 6.4575
131 train 6.4182
132 train 6.4207
133 train 6.3371
134 train 6.3390
135 train 6.4133
136 train 6.3743
137 train 6.4040
138 train 6.3337
139 train 6.4392
139 eval 6.4248
140 train 6.5559
141 train 6.4412
142 train 6.4924
143 train 6.4386
144 train 6.4539
145 train 6.4280
146 train 6.4519
147 train 6.4542
148 train 6.4465
149 train 6.4277
149 eval 6.3705
150 train 6.4331
151 train 6.3312
152 train 6.3699
153 train 6.4266
154 train 6.3328
155 train 6.3070
156 train 6.3665
157 train 6.4140
158 train 6.4185
159 train 6.3274
159 eval 6.3108
160 train 6.2782
161 train 6.3637
162 train 6.2615
163 train 6.2279
164 train 6.2529
165 train 6.2858
166 train 6.1396
167 train 6.2463
168 train 6.2270
169 train 6.2441
169 eval 6.2693
170 train 6.2160
171 train 6.2452
172 train 6.2232
173 train 6.1763
174 train 6.1503
175 train 6.2086
176 train 6.1519
177 train 6.1914
178 train 6.1265
179 train 6.1058
179 eval 6.2244
180 train 6.1044
181 train 6.1331
182 train 6.1243
183 train 6.1165
184 train 6.1452
185 train 6.2055
186 train 6.2322
187 train 6.3078
188 train 6.2550
189 train 6.2225
189 eval 6.1892
190 train 6.2568
191 train 6.2169
192 train 6.2202
193 train 6.2215
194 train 6.1458
195 train 6.1509
196 train 6.1372
197 train 6.1700
198 train 6.1761
199 train 6.1320
199 eval 6.1280
max_lr: 0.0012, min_lr: 0.00011999999999999999, steps: 19073, warmup_steps: 715.2557373046875
200 train 6.1372
201 train 6.1128
202 train 6.1320
203 train 6.1151
204 train 6.1093
205 train 6.1682
206 train 6.1541
207 train 6.1147
208 train 6.0733
209 train 6.0101
209 eval 6.1017
210 train 6.0464
211 train 6.0921
212 train 6.1005
213 train 6.0914
214 train 6.0794
215 train 6.0894
216 train 6.0299
217 train 6.0398
218 train 6.0042
219 train 5.9990
219 eval 6.0585
220 train 5.9656
221 train 5.9632
222 train 5.9939
223 train 5.9309
224 train 5.9476
225 train 5.9379
226 train 5.8996
227 train 6.0046
228 train 5.9331
229 train 5.9096
229 eval 6.0351
230 train 5.9388
231 train 5.8964
232 train 6.0730
233 train 6.0893
234 train 6.1038
235 train 6.1001
236 train 6.1196
237 train 6.1153
238 train 6.0517
239 train 6.0338
239 eval 6.0008
240 train 6.0577
241 train 6.0395
242 train 6.0421
243 train 6.0448
244 train 5.9781
245 train 5.9228
246 train 5.9486
247 train 6.0054
248 train 5.9882
249 train 5.9489
249 eval 5.9526
250 train 5.9903
251 train 5.9286
252 train 5.9779
253 train 5.9667
254 train 5.9846
255 train 5.8942
256 train 5.9257
257 train 5.9030
258 train 5.8835
259 train 5.8993
259 eval 5.9199
260 train 5.8349
261 train 5.8835
262 train 5.8448
263 train 5.8288
264 train 5.8404
265 train 5.8489
266 train 5.8797
267 train 5.7788
268 train 5.7820
269 train 5.8369
269 eval 5.9055
270 train 5.8399
271 train 5.7891
272 train 5.7963
273 train 5.7884
274 train 5.7469
275 train 5.8153
276 train 5.8227
277 train 5.7659
278 train 5.9208
279 train 5.8725
279 eval 5.8758
280 train 5.9275
281 train 5.8946
282 train 5.8790
283 train 5.8891
284 train 5.9465
285 train 5.8961
286 train 5.9022
287 train 5.8689
288 train 5.8262
289 train 5.8492
289 eval 5.8323
290 train 5.7968
291 train 5.8085
292 train 5.7609
293 train 5.8124
294 train 5.8610
295 train 5.8277
296 train 5.8078
297 train 5.8039
298 train 5.7848
299 train 5.7638
299 eval 5.7730
max_lr: 0.0012, min_lr: 0.00011999999999999999, steps: 19073, warmup_steps: 715.2557373046875
300 train 5.8528
301 train 5.7181
302 train 5.7376
303 train 5.7448
304 train 5.6975
305 train 5.7010
306 train 5.6867
307 train 5.6863
308 train 5.6958
309 train 5.6753
309 eval 5.7589
310 train 5.6757
311 train 5.6720
312 train 5.6575
313 train 5.6273
314 train 5.6259
315 train 5.5904
316 train 5.6430
317 train 5.5900
318 train 5.6206
319 train 5.5921
319 eval 5.6902
320 train 5.5394
321 train 5.5774
322 train 5.5481
323 train 5.5775
324 train 5.7160
325 train 5.7737
326 train 5.7938
327 train 5.7934
328 train 5.7973
329 train 5.7617
329 eval 5.7113
330 train 5.7735
331 train 5.7371
332 train 5.7556
333 train 5.7048
334 train 5.7296
335 train 5.7323
336 train 5.6348
337 train 5.6605
338 train 5.6867
339 train 5.6611
339 eval 5.6593
340 train 5.6813
341 train 5.6569
342 train 5.6914
343 train 5.6091
344 train 5.6543
345 train 5.6359
346 train 5.6175
347 train 5.6404
348 train 5.5793
349 train 5.5809
349 eval 5.6124
350 train 5.5725
351 train 5.5852
352 train 5.5355
353 train 5.5346
354 train 5.5958
355 train 5.5608
356 train 5.4952
357 train 5.5125
358 train 5.5068
359 train 5.4536
359 eval 5.5663
360 train 5.4654
361 train 5.4967
362 train 5.5274
363 train 5.4514
364 train 5.4856
365 train 5.4433
366 train 5.4157
367 train 5.4709
368 train 5.4904
369 train 5.4094
369 eval 5.5550
370 train 5.4544
371 train 5.5634
372 train 5.6450
373 train 5.5434
374 train 5.5657
375 train 5.5909
376 train 5.6074
377 train 5.6035
378 train 5.6270
379 train 5.5381
379 eval 5.5217
380 train 5.5551
381 train 5.5386
382 train 5.4960
383 train 5.4926
384 train 5.4601
385 train 5.5343
386 train 5.5448
387 train 5.5216
388 train 5.4429
389 train 5.4990
389 eval 5.4683
390 train 5.4789
391 train 5.4857
392 train 5.4190
393 train 5.4569
394 train 5.3906
395 train 5.3352
396 train 5.3702
397 train 5.3771
398 train 5.3610
399 train 5.3887
399 eval 5.4425
max_lr: 0.0012, min_lr: 0.00011999999999999999, steps: 19073, warmup_steps: 715.2557373046875
400 train 5.3904
401 train 5.3767
402 train 5.3631
403 train 5.3674
404 train 5.3653
405 train 5.3465
406 train 5.2951
407 train 5.2782
408 train 5.2865
409 train 5.2808
409 eval 5.4003
410 train 5.2753
411 train 5.3068
412 train 5.2917
413 train 5.2942
414 train 5.2830
415 train 5.2777
416 train 5.3355
417 train 5.4568
418 train 5.4335
419 train 5.4534
419 eval 5.3746
420 train 5.4008
421 train 5.4371
422 train 5.4400
423 train 5.4959
424 train 5.4168
425 train 5.4077
426 train 5.3529
427 train 5.3493
428 train 5.3611
429 train 5.4400
429 eval 5.3361
430 train 5.4002
431 train 5.3431
432 train 5.4175
433 train 5.4144
434 train 5.2972
435 train 5.3316
436 train 5.2759
437 train 5.3820
438 train 5.3772
439 train 5.3460
439 eval 5.2900
440 train 5.1873
441 train 5.2522
442 train 5.2423
443 train 5.2353
444 train 5.2588
445 train 5.2544
446 train 5.2454
447 train 5.2864
448 train 5.2860
449 train 5.2132
449 eval 5.2636
450 train 5.2220
451 train 5.2505
452 train 5.1344
453 train 5.1727
454 train 5.1673
455 train 5.0807
456 train 5.1502
457 train 5.1251
458 train 5.1442
459 train 5.1846
459 eval 5.2645
460 train 5.1468
461 train 5.1321
462 train 5.0466
463 train 5.1598
464 train 5.2063
465 train 5.2321
466 train 5.2870
467 train 5.2174
468 train 5.2506
469 train 5.2952
469 eval 5.2385
470 train 5.2568
471 train 5.2250
472 train 5.2987
473 train 5.2536
474 train 5.2856
475 train 5.2383
476 train 5.1585
477 train 5.2419
478 train 5.1802
479 train 5.2350
479 eval 5.1564
480 train 5.1824
481 train 5.2195
482 train 5.1708
483 train 5.2189
484 train 5.1362
485 train 5.1909
486 train 5.1488
487 train 5.1659
488 train 5.1077
489 train 5.0742
489 eval 5.1235
490 train 5.1019
491 train 5.0906
492 train 5.1066
493 train 5.0770
494 train 5.1297
495 train 5.0861
496 train 5.1183
497 train 5.0975
498 train 5.0462
499 train 4.9826
499 eval 5.1009
max_lr: 0.0012, min_lr: 0.00011999999999999999, steps: 19073, warmup_steps: 715.2557373046875
500 train 5.0482
501 train 5.0074
502 train 4.9924
503 train 4.9781
504 train 5.0281
505 train 4.9927
506 train 4.9793
507 train 5.0241
508 train 4.9128
509 train 4.9545
510 train 5.1039
511 train 5.1286
512 train 5.1077
513 train 5.0873
514 train 5.1090
515 train 5.0869
516 train 5.2390
517 train 5.1787
518 train 5.1079
519 train 5.1632
520 train 5.1631
521 train 5.1543
522 train 5.1186
523 train 5.0546
524 train 5.0675
525 train 5.0403
526 train 5.0586
527 train 5.0547
528 train 5.0414
529 train 5.0750
530 train 5.0605
531 train 5.0375
532 train 4.9908
533 train 5.0270
534 train 4.9529
535 train 4.9596
536 train 5.0247
537 train 4.9283
538 train 4.9637
539 train 4.9468
540 train 4.9513
541 train 4.9126
542 train 4.9800
543 train 4.9613
544 train 4.9589
545 train 4.8875
546 train 4.8376
547 train 4.8208
548 train 4.8794
549 train 4.9008
550 train 4.9105
551 train 4.8924
552 train 4.8352
553 train 4.9202
554 train 4.8613
555 train 4.8351
556 train 4.8666
557 train 4.9765
558 train 5.0020
559 train 4.9439
560 train 4.9798
561 train 4.9416
562 train 4.9368
563 train 4.9441
564 train 5.0107
565 train 4.9874
566 train 4.9383
567 train 5.0049
568 train 4.9303
569 train 4.9683
570 train 4.9076
571 train 4.8919
572 train 4.9059
573 train 4.9009
574 train 4.8660
575 train 4.8604
576 train 4.8856
577 train 4.8834
578 train 4.8784
579 train 4.8602
580 train 4.8150
581 train 4.8622
582 train 4.6922
583 train 4.7685
584 train 4.8116
585 train 4.7890
586 train 4.8228
587 train 4.8690
588 train 4.8592
589 train 4.8783
590 train 4.8467
591 train 4.8359
592 train 4.6978
593 train 4.7065
594 train 4.7278
595 train 4.7863
596 train 4.6982
597 train 4.7348
598 train 4.7466
599 train 4.6849
599 eval 4.8195
600 train 4.6882
601 train 4.6650
602 train 4.6713
603 train 4.7577
604 train 4.8485
605 train 4.8877
606 train 4.8370
607 train 4.8453
608 train 4.8139
609 train 4.8104
610 train 4.8225
611 train 4.8122
612 train 4.8178
613 train 4.7587
614 train 4.7951
615 train 4.8233
616 train 4.7465
617 train 4.7719
618 train 4.7379
619 train 4.7311
620 train 4.8078
621 train 4.7641
622 train 4.7770
623 train 4.7587
624 train 4.7335
625 train 4.7358
626 train 4.7644
627 train 4.6598
628 train 4.7119
629 train 4.6452
630 train 4.7207
631 train 4.7088
632 train 4.7007
633 train 4.7191
634 train 4.7297
635 train 4.7403
636 train 4.7419
637 train 4.9971
638 train 4.6919
639 train 4.7082
640 train 4.6113
641 train 4.6759
642 train 4.6706
643 train 4.6749
644 train 4.6467
645 train 4.6009
646 train 4.6117
647 train 4.6052
648 train 4.6204
649 train 4.5805
650 train 4.6915
651 train 4.7641
652 train 4.8831
653 train 4.7621
654 train 4.7278
655 train 4.7821
656 train 4.7737
657 train 4.7046
658 train 4.7009
659 train 4.7556
660 train 4.6780
661 train 4.7017
662 train 4.6323
663 train 4.6212
664 train 4.6217
665 train 4.6011
666 train 4.6546
667 train 4.6186
668 train 4.5931
669 train 4.6121
670 train 4.5466
671 train 4.6206
672 train 4.6026
673 train 4.5646
674 train 4.5343
675 train 4.5315
676 train 4.5797
677 train 4.5962
678 train 4.5719
679 train 4.5264
680 train 4.5431
681 train 4.5114
682 train 4.5447
683 train 4.5466
684 train 4.5362
685 train 4.4621
686 train 4.4505
687 train 4.4918
688 train 4.4912
689 train 4.4731
690 train 4.4986
691 train 4.5059
692 train 4.5188
693 train 4.4468
694 train 4.5108
695 train 4.3988
696 train 4.5515
697 train 4.6206
698 train 4.7344
699 train 4.5999
699 eval 4.5310
700 train 4.6086
701 train 4.5791
702 train 4.5274